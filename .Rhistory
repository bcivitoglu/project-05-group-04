#Nested for loop
##Load dataset
input_data <- readRDS(file ="CLL-Bcells_list.RDS.gz")
##Add subgroup "genes"
genes <- input_data$genes
cov_genes <- genes[,c(21:30)]
sum(is.na(cov_genes))
cov_genes[is.na(cov_genes)] <- 0
cov_genes_mean <- rowMeans(data.matrix(cov_genes))
threshhold1 <- 10
threshhold2 <- quantile(cov_genes_mean, probs = seq(0.95,0.95,0.05))
View(cov_genes)
for(i in 1:ncol(cov_genes)){
for(j in 1:nrow(cov_genes)){
if(isTRUE(cov_genes[i,j] <= threshhold1)){
cov_genes[i,j] <- NA
}
if(isTRUE(cov_genes[i,j] >= threshhold2)){
cov_genes[i,j] <- NA
}
}
}
View(cov_genes)
View(cov_genes)
# Start the project
# Legend
df = data frame
# To make sure which file on my computer offers the environment for my R project:
getwd()
# Read in the data
input_data <- readRDS(file ="CLL-Bcells_list.RDS.gz")
annotation <- read.csv("sample_annotation.csv")
## Divide the data in 4 subgroups
genes <- input_data$genes
promoters <- input_data$promoters
cpgislands <- input_data$cpgislands
tiling <- input_data$tiling
# Rename a column
## If you know the number of the columns
names(df)[number_of_col] <- "new_name"
E.g: names(genes)[1] <- "new_name"
## If you have too many columns to know the number
colnames(df)[colnames(df)=="old_name"] <- "new_name"
E.g: colnames(genes)[colnames(genes)=="old_name"] <- "new_name"
# Dealing with NA
## Show if columns have missing values
sum(is.na(df))
--> Number of missing values is shown as result
## Set NAÂ´s to a defined number
df[is.na(df)] <- set_number
E.g.: genes$Symbol[is.na(genes$Symbol)] <- 0
## Set 0 to NA
df[df == 0] <- NA
E.g.: genes$Symbol[genes$Symbol == 0] <- NA
# Create new data frames with selected columns
## Create a data frame with selected columns using indices
dfnew1 <- genes[,c(1,2,3,4,5)]
## Create a data frame with selected columns using indices (easier)
dfnew2 <- genes [, c(1:5)]
## Create a data frame using the names of the columns
dfnew1 <- data.frame(df$subpoint1, df$subpoint2)
E.g.: dfnew1 <- data.frame(genes$Chromosome, genes$CpG)
### Rename all the (old) columns at once ("Chromosome" --> "Chr" ; "CpG" --> "CpGÃÂ´s")
names(dfnew1) <- c("Chr", "CpG ÃÂ´s")
#Visualization
## Histogram
hist(df, main = "Headline", xlab = "Name of x-axis", xlim = c(Starting_Number, Ending_Number), breaks = How_Many_Intervalls)
hist(cpgislands$CpG, main = "Histogram for CpG derivation", xlab = "Number of CpGÃÂ´s in Region", xlim = c(0,600), breaks = 200)
## Density plot
plot(df), xlab = "X-axis name", main = "",xlim = c(Starting_Number, Ending_Number))
plot(density(genes$CpG), xlab = "Number of CpGÃÂ´s", main = "",xlim = c(0,2000))
## Boxplots
boxplot(df1,df2)
boxplot(df1,df2, xlab = "Example_1", horizontal = T, ylim = c(0,1), ylab = "Non-cancer vs. CLL")
# Clean up our data
## Beta Values
###1 Set all Zero to NAÃÂ´s (due to possible mistakes)
df[df == 0] <- NA
###2 Go through each row and sum up the NAÃÂ´s
rmv.rows = apply(df,1, function(x){sum(is.na(x))})
###3 Number of NA`s greater i
which(rmv.rows > i)
### Or even i
which (rmv.rows == i)
###4 Remove your old Dataset with the NAÃÂ´s with your new Dataset without the NAÃÂ´s (Remove any row with more than i NAÃÂ´s)
df = df[-which(rmv.rows > i),]
## Coverage Values
###1 Show me all the Values within the 90% quantile
df[df$specialcolumn < quantile(df$specialcolumn, 0.90),]
###2 Create new dataset with just the values inside 90% quantile
df_new = df[df$specialcolumn < quantile(df$specialcolumn, 0.90),]
--> Care: You remove the the rows, which only belong to ONE column (df$specialcomun)
##3 If you want to know a percentile to compare(In this case the 80%, 90%, 95% "percentile")
quantile(df, c(0.80, .90, .95))
View(dfnew1)
View(cpgislands)
#Nested for loop
##Load dataset
input_data <- readRDS(file ="CLL-Bcells_list.RDS.gz")
##Add subgroup "genes"
genes <- input_data$genes
##Make a dataset with coverage values only
cov_genes <- genes[,c(21:30)]
##Mean of every gene (check for NA´s first and set them to zero if NA´s available)
sum(is.na(cov_genes))
cov_genes[is.na(cov_genes)] <- 0
cov_genes_mean <- rowMeans(data.matrix(cov_genes))
##Set threshhold
threshhold1 <- 10
threshhold2 <- quantile(cov_genes_mean, probs = seq(0.95,0.95,0.05))
View(threshhold2)
View(cov_genes)
for(i in 1:ncol(cov_genes)){
for(j in 1:nrow(cov_genes)){
if(isTRUE(cov_genes[i,j] <= threshhold1)){
cov_genes[i,j] <- NA
}
if(isTRUE(cov_genes[i,j] >= threshhold2)){
cov_genes[i,j] <- NA
}
}
}
View(cov_genes)
