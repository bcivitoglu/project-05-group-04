# Start the project

# Legend

   df = data frame

# To make sure which file on my computer offers the environment for my R project:

 getwd()
  
  

# Read in the data

  input_data <- readRDS(file ="CLL-Bcells_list.RDS.gz")

  annotation <- read.csv("sample_annotation.csv")

## Divide the data in 4 subgroups

  genes <- input_data$genes

  promoters <- input_data$promoters

  cpgislands <- input_data$cpgislands

  tiling <- input_data$tiling
 
 
  
# Rename a column

## If you know the number of the columns

  names(df)[number_of_col] <- "new_name"
  E.g: names(genes)[1] <- "new_name"

## If you have too many columns to know the number

  colnames(df)[colnames(df)=="old_name"] <- "new_name"
  E.g: colnames(genes)[colnames(genes)=="old_name"] <- "new_name"
  
  
# Dealing with NA

## Show if columns have missing values

  sum(is.na(df))
  --> Number of missing values is shown as result

## Set NA´s to a defined number

  df[is.na(df)] <- set_number
  E.g.: genes$Symbol[is.na(genes$Symbol)] <- 0

## Set 0 to NA

  df[df == 0] <- NA
  E.g.: genes$Symbol[genes$Symbol == 0] <- NA
  
  

# Create new data frames with selected columns

## Create a data frame with selected columns using indices

  dfnew1 <- genes[,c(1,2,3,4,5)]

## Create a data frame with selected columns using indices (easier)

  dfnew2 <- genes [, c(1:5)]

## Create a data frame using the names of the columns

  dfnew1 <- data.frame(df$subpoint1, df$subpoint2)
  E.g.: dfnew1 <- data.frame(genes$Chromosome, genes$CpG)

### Rename all the (old) columns at once ("Chromosome" --> "Chr" ; "CpG" --> "CpGÂ´s")

  names(dfnew1) <- c("Chr", "CpG Â´s")



#Visualization

## Histogram

  hist(df, main = "Headline", xlab = "Name of x-axis", xlim = c(Starting_Number, Ending_Number), breaks = How_Many_Intervalls)

  hist(cpgislands$CpG, main = "Histogram for CpG derivation", xlab = "Number of CpGÂ´s in Region", xlim = c(0,600), breaks = 200)

## Density plot

  plot(df), xlab = "X-axis name", main = "",xlim = c(Starting_Number, Ending_Number))

  plot(density(genes$CpG), xlab = "Number of CpGÂ´s", main = "",xlim = c(0,2000))

## Boxplots

  boxplot(df1,df2)

  boxplot(df1,df2, xlab = "Example_1", horizontal = T, ylim = c(0,1), ylab = "Non-cancer vs. CLL")




# Clean up our data

## Beta Values

###1 Set all Zero to NAÂ´s (due to possible mistakes)

  df[df == 0] <- NA

###2 Go through each row and sum up the NAÂ´s

  rmv.rows = apply(df,1, function(x){sum(is.na(x))})

###3 Number of NA`s greater i

  which(rmv.rows > i)

### Or even i

  which (rmv.rows == i)

###4 Remove your old Dataset with the NAÂ´s with your new Dataset without the NAÂ´s (Remove any row with more than i NAÂ´s)

  df = df[-which(rmv.rows > i),]


## Coverage Values

###1 Show me all the Values within the 90% quantile

  df[df$specialcolumn < quantile(df$specialcolumn, 0.90),]

###2 Create new dataset with just the values inside 90% quantile

  df_new = df[df$specialcolumn < quantile(df$specialcolumn, 0.90),]

--> Care: You remove the the rows, which only belong to ONE column (df$specialcomun)

##3 If you want to know a percentile to compare(In this case the 80%, 90%, 95% "percentile")

  quantile(df, c(0.80, .90, .95))
  

#Prepare for a nested for loop

##Check for NA´s in our dataset we want to clean

sum(is.na(cov_gene_healthy))

--> if the answer is anything above 0, remove the NA or set it to a value which we want to remove anyway

cov_genes_healthy[is.na(cov_genes_healthy)] <- 0

##Define the length and the number of rows from our dataset to use this code universally

n = length(cov_genes_healthy)

m = nrow(cov_genes_healthy)

##Define the two threshholds from our mean data set 

threshhold1 <- quantile(cov_genes_means, probs = seq(0.011,0.011,0.05), na.rm = TRUE)

threshhold2 <- quantile (cov_genes_means, probs = seq(0.95,0.95,0.05), na.rm = TRUE)

##The actual nested for loop --> Doenst work 

for (i in 1:m) {
  for (j in 1:n) {
    if (cov_genes_healthy[i, j] < threshhold1){
      cov_genes_healthy[i, j] <- NA  
    }
        if (cov_genes_healthy[i, j] > threshhold2){
          cov_genes_healthy[i, j] <- NA
        }
  }
}

